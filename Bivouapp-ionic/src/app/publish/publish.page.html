<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/tabs/explore" text="" icon="chevron-back"></ion-back-button>
    </ion-buttons>
    <ion-title>Publier un spot</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="publish-container">
    <form [formGroup]="spotForm" (ngSubmit)="onSubmit()">

      <div class="input-group">
        <label>Titre</label>
        <ion-input class="custom-input" formControlName="title" placeholder="Ajouter un titre"></ion-input>
      </div>

      <div class="input-group">
        <label>Description</label>
        <ion-textarea class="custom-input" formControlName="description" placeholder="Ajouter une description..." rows="4"></ion-textarea>
      </div>

      <div class="input-group">
        <label>Localisation</label>
        <div class="map-wrapper">
          <div id="map-publish"></div>
          <div class="map-overlay">
            <ion-icon name="location"></ion-icon>

            <span>
              {{ spotForm.get('latitude')?.value | number:'1.2-2' }},
              {{ spotForm.get('longitude')?.value | number:'1.2-2' }}
            </span>
          </div>
        </div>
      </div>

      <ion-row>
        <ion-col size="6">
          <div class="input-group">
            <label>Note</label>
            <div class="stars-row">
              @for (s of [1,2,3,4,5]; track s) {
                <ion-icon
                  [name]="spotForm.get('rating')?.value >= s ? 'star' : 'star-outline'"
                  [class.active]="spotForm.get('rating')?.value >= s"
                  (click)="setRating(s)">
                </ion-icon>
              }
            </div>
          </div>
        </ion-col>
        <ion-col size="6">
          <div class="input-group">
            <label>Prix</label>
            <div class="price-input-wrapper">
              <ion-input type="number" formControlName="price" placeholder="Prix"></ion-input>
              <span class="currency">€</span>
            </div>
          </div>
        </ion-col>
      </ion-row>

      <div class="input-group">
        <label>Services</label>
        <div class="services-scroll">
          @for (service of allServices; track service.id) {
            <div class="service-box"
                 [class.selected]="isServiceSelected(service.id)"
                 (click)="toggleService(service.id)">
              <ion-icon [name]="service.icon"></ion-icon>
              <span>{{ service.label }}</span>
            </div>
          }
        </div>
      </div>

      <div class="input-group">
        <div class="media-header">
          <ion-icon name="add-circle-outline"></ion-icon>
          <span>Ajouter médias</span>
        </div>
        <div class="media-preview">
          <div class="img-box add"><ion-icon name="camera"></ion-icon></div>
          <div class="img-box"><img src="https://images.unsplash.com/photo-1504280390367-361c6d9f38f4?w=200"></div>
        </div>
      </div>

      <ion-button expand="block" type="submit" class="submit-btn" [disabled]="spotForm.invalid">
        Publier le spot
      </ion-button>

    </form>
  </div>
</ion-content>

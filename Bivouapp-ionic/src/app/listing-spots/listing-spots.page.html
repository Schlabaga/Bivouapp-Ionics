<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/tabs/explore"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ pageTitle }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">{{ pageTitle }}</ion-title>
    </ion-toolbar>
  </ion-header>

  <div class="listing-container">
    @if (spots.length > 0) {
      <ion-grid class="spots-grid">
        <ion-row>
          @for (spot of spots; track spot.id) {
            <ion-col size="6" size-md="3">
              <ion-card class="spot-card" (click)="openSpotDetail(spot.id)">
                <div class="image-container">
                  <img [src]="spot.imageUrl" [alt]="spot.title" class="spot-image">

                  <ion-button
                    fill="clear"
                    class="favorite-btn"
                    (click)="toggleFavorite(spot, $event)">
                    <ion-icon
                      [name]="spot.isFavorite ? 'heart' : 'heart-outline'"
                      [color]="spot.isFavorite ? 'danger' : 'medium'">
                    </ion-icon>
                  </ion-button>
                </div>

                <ion-card-content class="spot-info">
                  <div class="header-row">
                    <ion-text class="location">{{ spot.location }}</ion-text>
                    <ion-text class="rating">
                      <ion-icon name="star" color="warning"></ion-icon>
                      {{ spot.rating }}
                    </ion-text>
                  </div>

                  <ion-text class="title">
                    <h3>{{ spot.title }}</h3>
                  </ion-text>

                  <ion-text class="dates" color="medium">
                    <p>15 - 20 juil.</p>
                  </ion-text>

                  @if (spot.price > 0) {
                    <ion-text class="price">
                      <p>
                        <strong>{{ spot.price | currency: 'EUR' }}</strong>
                        @if (spot.type !== "point d'eau") {
                          <span> par nuit</span>
                        }
                      </p>
                    </ion-text>
                  } @else if (spot.price === 0) {
                    <ion-text class="free" color="success">
                      <p><strong>Gratuit</strong></p>
                    </ion-text>
                  }
                </ion-card-content>
              </ion-card>
            </ion-col>
          }
        </ion-row>
      </ion-grid>
    } @else {
      <div class="empty-state">
        <ion-icon
          [name]="mode === 'favorites' ? 'heart-dislike-outline' : 'location-outline'"
          color="medium">
        </ion-icon>
        <h3>{{ mode === 'favorites' ? 'Aucun favori pour le moment' : 'Aucun spot trouvé' }}</h3>
        <p>{{ mode === 'favorites' ? 'Explorez les spots et ajoutez-les à vos favoris !' : 'Revenez plus tard' }}</p>
        @if (mode === 'favorites') {
          <ion-button routerLink="/tabs/explore" expand="block">
            Explorer les spots
          </ion-button>
        }
      </div>
    }
  </div>
</ion-content>
